<!DOCTYPE html>
<html>

	<head>

		<meta charset = "utf-8">
		<title>Pregled kategorija</title>
	
		<script type = "text/javascript" src = "js/jquery.js"></script>
        <script type = "text/javascript">

            function pregledOrganizacija()
			{
				$.ajax({
					type: "GET",
					url: "dobaviTrenutnogKorisnika",
					data: 0,
					contentType: "application/json",
					dataType: "json",
					success: function(data)
					{
						if(data === false){
							alert("Morate biti ulogovani da biste pristupili ovoj stranici")
							location.href = "/index.html"
						}else if (data === 2 || data === 1){
							alert("Nemate pristup ovoj stranici")
							location.href = "/pregledVM.html"
						}else{
							var korisnik = data;
							ispisTabele(korisnik);
						}	
					}
				})
            }
            
            function ispisTabele(korisnik)
            {
                $.ajax({
					type: "GET",
					url: "dobaviKategorije",
					data: 0,
					contentType: "application/json",
					dataType: "json",
                    success: function(data)
                    {
                        if (korisnik === 0 )
                        {
                            data.forEach(element => {
								$("#tabelaKategorija").append($("<tr>")
                                                            .append($("<td>")
                                                                .text(element.ime))
                                                            .append($("<td>")
                                                                .text(element.brojJezgara))
                                                            .append($("<td>")
                                                                .text(element.RAM))
                                                            .append($("<td>")
                                                                .text(element.GPU))
                                                            .append($("<td>")
                                                                .append($("<a>")
                                                                    .attr("href", "#")
                                                                    .attr("id", element.ime)
                                                                    .attr("onclick", "izmeniKategoriju(this)")
                                                                    .text("Izmeni")))	
                                                                    .append($("<td>")
															.append($("<a>")
																.attr("href", "#")
																.attr("id", element.ime)
																.attr("onclick", "obrisiKategoriju(this)")
																.text("Obrisi")))		
													 )
							})
                        }
                    }
                })
            }

            function izmeniKategoriju(data)
			{
				$.ajax
				({
					type : "POST",
					url: "izmeniKategoriju",
					data: $(data).attr("id"),
					success: function(data)
					{
						window.location.href = "izmenaKategorije.html";
					}
				})
            }
            
            function obrisiKategoriju(data){
                $("#tabelaKategorija").find("tr").each(function()
                {
                    var tds = $(this).find("td")
                    if(tds.eq(0).text()==$(data).attr("id"))
                    {
                        $(this).empty()
                    }
                })
                
                $.ajax
                ({
                    type: "POST",
                    url: "obrisiKategoriju",
                    data: $(data).attr("id"),
                    success: function(data)
                    {
                    }
                })
		    }
            
        </script>

    </head>

    <body onload = pregledKategorija()>
		<h2>Kategorije</h2>
		
		<table border = "1" id = "tabelaKategorija">
			<thead>
				<tr>
					<th>Ime</th>
                    <th>Broj jezgra</th>
                    <th>RAM</th>
                    <th>GPU</th>
                    <th>Izmena</th>
                    <th>Brisanje</th>
				</tr>
			</thead>
		</table>
		
		<hr>
		<input id = "dodajKategoriju" type="button" value="Dodaj novou kategoriju">
	</body>

</html>